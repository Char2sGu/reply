import{a as ve,b as Me,c as k,d as xe,e as ye}from"./chunk-SCW2PD66.js";import{b as A}from"./chunk-2SKRDM35.js";import"./chunk-JWYHAYBW.js";import{d as E,e as H}from"./chunk-BQG6VIZI.js";import"./chunk-MVUL6ZIM.js";import{d as _e}from"./chunk-LJ7UDTCX.js";import{c as ce,e as me,f as de,g as pe}from"./chunk-IJYCWCJA.js";import"./chunk-C6VMUQFT.js";import{a as he,b as ue,c as ge}from"./chunk-EFASKN6N.js";import{p as fe}from"./chunk-HDMEYBD3.js";import{a as ne,d as oe,e as re,f as ae,g as se,i as le}from"./chunk-IKTP4ODH.js";import{Ca as a,E as j,Gd as b,Ja as m,Jb as Y,Kb as w,La as s,Ma as l,N as O,Na as c,Oa as v,Pa as g,Pb as F,Qa as _,Qb as G,Sa as Z,Sc as q,Ua as D,Wa as d,X as $,Xd as T,Yc as J,Yd as P,Zc as K,_a as U,cb as M,da as h,db as C,e as I,fa as y,ga as S,ha as u,md as R,na as z,nb as p,nd as X,oa as V,ob as f,od as Q,p as x,pb as W,pd as ee,qd as te,s as B,td as ie}from"./chunk-KBDKS3MK.js";import"./chunk-3J24ZBPC.js";var N=(()=>{let e=class{},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275mod=u({type:e})})(),(()=>{e.\u0275inj=h({})})(),t})();var Ce=(()=>{let e=class{},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275mod=u({type:e})})(),(()=>{e.\u0275inj=h({providers:[J],imports:[N,E,q,N,E]})})(),t})();function be(t,e){if(t&1&&(l(0,"div",6)(1,"span"),M(2),c(),M(3," - "),l(4,"span"),M(5),p(6,"readableDate"),c()()),t&2){let o=e.ngIf,n=d(2).$implicit,i;a(2),C((i=o.name)!==null&&i!==void 0?i:o.email),a(3),C(f(6,2,n.sentAt))}}function Te(t,e){if(t&1&&(l(0,"a",4),v(1,"mat-icon",5),l(2,"div",6),M(3),c(),m(4,be,7,4,"div",7),p(5,"async"),p(6,"contactFromMailParticipant"),c()),t&2){let o=e.ngIf,n=d().$implicit;U("routerLink","/mailboxes/",o.name,"/mails/",n.id,""),a(3),C(n.subject),a(1),s("ngIf",f(5,4,f(6,6,n.sender)))}}function Ae(t,e){if(t&1&&(g(0),m(1,Te,7,8,"a",3),p(2,"resolveRef"),_()),t&2){let o=e.$implicit,n=d(4).ngIf;a(1),s("ngIf",o.mailbox&&W(2,1,o.mailbox,n))}}function He(t,e){if(t&1&&(g(0),l(1,"div",2),M(2),c(),m(3,Ae,3,4,"ng-container",1),_()),t&2){let o=d().$implicit;a(2),C(o.name),a(1),s("ngForOf",o.items)}}function De(t,e){if(t&1&&(g(0),m(1,He,4,2,"ng-container",0),_()),t&2){let o=e.$implicit;a(1),s("ngIf",o.items.length)}}function Pe(t,e){if(t&1&&(l(0,"mat-nav-list"),m(1,De,2,1,"ng-container",1),c()),t&2){let o=e.ngIf;a(1),s("ngForOf",o)}}function ke(t,e){if(t&1&&(g(0),m(1,Pe,2,1,"mat-nav-list",0),p(2,"async"),_()),t&2){let o=d();a(1),s("ngIf",f(2,1,o.mailsGroups$))}}var Ee=(()=>{let e=class{constructor(){this.store=y(b),this.mailboxes$=this.store.select(fe.selectMailboxes),this.mails$=new I([]),this.mailsGroups$=this.mails$.pipe(x(n=>{let i={Yesterday:[],["This Week"]:[],Earlier:[]};return n.forEach(r=>{k().subtract(1,"day").isBefore(r.sentAt)?i.Yesterday.push(r):k().subtract(1,"week").isBefore(r.sentAt)?i["This Week"].push(r):i.Earlier.push(r)}),[{name:"Yesterday",items:i.Yesterday},{name:"This Week",items:i["This Week"]},{name:"Earlier",items:i.Earlier}]}))}set mails(n){this.mails$.next(n)}},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275cmp=S({type:e,selectors:[["rpl-search-result-list"]],inputs:{mails:"mails"},decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"subheader"],["mat-list-item","",3,"routerLink",4,"ngIf"],["mat-list-item","",3,"routerLink"],["matListIcon","","fontSet","filled","fontIcon","schedule"],["matLine",""],["matLine","",4,"ngIf"]],template:function(i,r){i&1&&(m(0,ke,3,3,"ng-container",0),p(1,"async")),i&2&&s("ngIf",f(1,1,r.mailboxes$))},dependencies:[Y,w,T,R,ce,de,K,me,F,ye,ve,xe],styles:[".subheader[_ngcontent-%COMP%]{margin:12px 20px;text-transform:uppercase}"],changeDetection:0})})(),t})();function Be(t,e){if(t&1){let o=Z();g(0),l(1,"rpl-header",1)(2,"a",2),v(3,"mat-icon",3),c(),l(4,"input",4),D("ngModelChange",function(i){z(o);let r=d();return V(r.searchText$.next(i))}),c(),l(5,"button",5),v(6,"mat-icon",6),c()(),l(7,"rpl-scrollable-area",7),v(8,"rpl-search-result-list",8),c(),_()}if(t&2){let o=e.ngIf,n=d(),i;a(2),s("routerLink",(i=n.lastActiveNavItem())==null?null:i.url),a(2),s("ngModel",n.searchText$.value),a(4),s("mails",o)}}var Le=(()=>{let e=class{constructor(){this.store=y(b),this.navService=y(ge),this.lastActiveNavItem=ie(this.navService.lastActiveItem$,{requireSync:!0}),this.searchText$=new I(""),this.mails$=B(this.searchText$.pipe(O()),this.searchText$.pipe(j(200))).pipe(x(n=>n.split(" ")),$(n=>this.store.select(_e.selectMails).pipe(x(i=>i.query(({subject:r})=>!!r&&this.matchKeyword(r,n))))))}matchKeyword(n,i){return i.some(r=>n.toLowerCase().includes(r.toLowerCase()))}},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275cmp=S({type:e,selectors:[["rpl-search"]],decls:2,vars:3,consts:[[4,"ngIf"],["ngForm","",1,"search-bar"],["mat-icon-button","","matTooltip","Back",3,"routerLink"],["fontSet","filled","fontIcon","arrow_back"],["name","search","type","text","placeholder","Search emails",3,"ngModel","ngModelChange"],["mat-icon-button",""],["fontSet","filled","fontIcon","mic"],["rplLayoutContent","","data-route-animation-target","",1,"search-result"],[3,"mails"]],template:function(i,r){i&1&&(m(0,Be,9,3,"ng-container",0),p(1,"async")),i&2&&s("ngIf",f(1,1,r.mails$))},dependencies:[w,ne,oe,re,se,ae,T,Q,ee,R,he,A,Me,H,Ee,F],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:0;flex-grow:1;font-size:18px;font-weight:400;line-height:24px;font-family:Work Sans,sans-serif;letter-spacing:normal}.search-result[_ngcontent-%COMP%]{height:0;flex-grow:1}"],changeDetection:0})})(),t})();var Oe=[{path:"",component:Le,title:"Search",data:{animationId:"search"}}],Ie=(()=>{let e=class{},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275mod=u({type:e})})(),(()=>{e.\u0275inj=h({imports:[P.forChild(Oe),P]})})(),t})();var oi=(()=>{let e=class{},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275mod=u({type:e})})(),(()=>{e.\u0275inj=h({imports:[G,le,Ie,te,X,E,Ce,pe,ue,A,H]})})(),t})();export{oi as SearchModule};
