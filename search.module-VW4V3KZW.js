import{a as _e,b as xe,c as Me,d as T}from"./chunk-GXVGJF2N.js";import{d as te,e as ie,f as k}from"./chunk-5QDPU4Y2.js";import{d as C,e as H}from"./chunk-M73SF7I4.js";import{a as me,c as de,d as pe,e as he}from"./chunk-FHI7K4TK.js";import{b as ne}from"./chunk-MILDH525.js";import{a as ue,b as fe,c as ge}from"./chunk-TEA4CVZ4.js";import"./chunk-BTQVCDJX.js";import{b as oe,e as re,f as se,g as ae,h as le,j as ce}from"./chunk-AJ5EX2ND.js";import{Aa as m,Ab as W,Bb as w,Ca as a,Da as l,Ea as c,F as O,Fa as _,Ga as x,Gb as S,Ha as M,Hb as Y,Ja as U,Jc as G,L as $,La as D,Na as d,Pc as J,Qc as q,Ra as Z,S as h,U as g,V as R,Va as v,W as u,Wa as y,ba as z,ca as V,dd as F,e as L,eb as p,ed as X,fb as f,fd as K,gb as A,gd as Q,hd as ee,m as I,o as j,qa as r,qd as b,sd as P,y as B}from"./chunk-HFIM43UT.js";import"./chunk-OPXGAHDX.js";var N=(()=>{let e=class{},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275mod=u({type:e})})(),(()=>{e.\u0275inj=h({})})(),t})();var ve=(()=>{let e=class{},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275mod=u({type:e})})(),(()=>{e.\u0275inj=h({providers:[J],imports:[N,C,G,N,C]})})(),t})();function Se(t,e){if(t&1&&(l(0,"div",6)(1,"span"),v(2),c(),v(3," - "),l(4,"span"),v(5),p(6,"readableDate"),c()()),t&2){let o=e.ngIf,n=d(2).$implicit,i;r(2),y((i=o.name)!==null&&i!==void 0?i:o.email),r(3),y(f(6,2,n.sentAt))}}function Fe(t,e){if(t&1&&(l(0,"a",4),_(1,"mat-icon",5),l(2,"div",6),v(3),c(),m(4,Se,7,4,"div",7),p(5,"async"),p(6,"resolveRef"),c()),t&2){let o=e.ngIf,n=d().$implicit,i=d(4);Z("routerLink","/mailboxes/",o.name,"/mails/",n.id,""),r(3),y(n.subject),r(1),a("ngIf",f(5,4,A(6,6,n.sender,i.contactRepo)))}}function be(t,e){if(t&1&&(x(0),m(1,Fe,7,9,"a",3),p(2,"async"),p(3,"resolveRef"),M()),t&2){let o=e.$implicit,n=d(4);r(1),a("ngIf",o.mailbox&&f(2,1,A(3,3,o.mailbox,n.mailboxRepo)))}}function Te(t,e){if(t&1&&(x(0),l(1,"div",2),v(2),c(),m(3,be,4,6,"ng-container",1),M()),t&2){let o=d().$implicit;r(2),y(o.name),r(1),a("ngForOf",o.items)}}function He(t,e){if(t&1&&(x(0),m(1,Te,4,2,"ng-container",0),M()),t&2){let o=e.$implicit;r(1),a("ngIf",o.items.length)}}function De(t,e){if(t&1&&(l(0,"mat-nav-list"),m(1,He,2,1,"ng-container",1),c()),t&2){let o=e.ngIf;r(1),a("ngForOf",o)}}var ye=(()=>{let e=class{set mails(n){this.mails$.next(n)}constructor(){this.contactRepo=g(te),this.mailboxRepo=g(ne),this.mails$=new L([])}ngOnInit(){this.mailsGroups$=this.mails$.pipe(I(n=>{let i={Yesterday:[],["This Week"]:[],Earlier:[]};return n.forEach(s=>{k().subtract(1,"day").isBefore(s.sentAt)?i.Yesterday.push(s):k().subtract(1,"week").isBefore(s.sentAt)?i["This Week"].push(s):i.Earlier.push(s)}),[{name:"Yesterday",items:i.Yesterday},{name:"This Week",items:i["This Week"]},{name:"Earlier",items:i.Earlier}]}))}},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275cmp=R({type:e,selectors:[["rpl-search-result-list"]],inputs:{mails:"mails"},decls:2,vars:3,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"subheader"],["mat-list-item","",3,"routerLink",4,"ngIf"],["mat-list-item","",3,"routerLink"],["matListIcon","","fontSet","filled","fontIcon","schedule"],["matLine",""],["matLine","",4,"ngIf"]],template:function(i,s){i&1&&(m(0,De,2,1,"mat-nav-list",0),p(1,"async")),i&2&&a("ngIf",f(1,1,s.mailsGroups$))},dependencies:[W,w,b,F,me,pe,q,de,S,_e,Me],styles:[".subheader[_ngcontent-%COMP%]{margin:12px 20px;text-transform:uppercase}"],changeDetection:0})})(),t})();function ke(t,e){if(t&1){let o=U();x(0),l(1,"rpl-header",1)(2,"a",2),_(3,"mat-icon",3),c(),l(4,"input",4),D("ngModelChange",function(i){z(o);let s=d();return V(s.searchText$.next(i))}),c(),l(5,"button",5),_(6,"mat-icon",6),c()(),l(7,"rpl-scrollable-area",7),_(8,"rpl-search-result-list",8),c(),M()}if(t&2){let o=e.ngIf,n=d(),i;r(2),a("routerLink",(i=n.navigationContext().latestMailboxUrl)!==null&&i!==void 0?i:"/"),r(2),a("ngModel",n.searchText$.value),r(4),a("mails",o)}}var Ce=(()=>{let e=class{constructor(){this.navigationContext=g(ge),this.mailRepo=g(ie),this.searchText$=new L("")}ngOnInit(){this.mails$=j(this.searchText$.pipe(O()),this.searchText$.pipe(B(200))).pipe(I(n=>n.split(" ")),$(n=>this.mailRepo.query(({subject:i})=>!!i&&n.some(s=>i.toLowerCase().includes(s.toLowerCase())))))}},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275cmp=R({type:e,selectors:[["rpl-search"]],decls:2,vars:3,consts:[[4,"ngIf"],["ngForm","",1,"search-bar"],["mat-icon-button","","matTooltip","Back",3,"routerLink"],["fontSet","filled","fontIcon","arrow_back"],["name","search","type","text","placeholder","Search emails",3,"ngModel","ngModelChange"],["mat-icon-button",""],["fontSet","filled","fontIcon","mic"],["rplLayoutContent","","data-route-animation-target","",1,"search-result"],[3,"mails"]],template:function(i,s){i&1&&(m(0,ke,9,3,"ng-container",0),p(1,"async")),i&2&&a("ngIf",f(1,1,s.mails$))},dependencies:[w,oe,re,se,le,ae,b,K,Q,F,ue,T,xe,H,ye,S],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:0;flex-grow:1;font-size:18px;font-weight:400;line-height:24px;font-family:Work Sans,sans-serif;letter-spacing:normal}.search-result[_ngcontent-%COMP%]{height:0;flex-grow:1}"],changeDetection:0})})(),t})();var Ne=[{path:"",component:Ce,title:"Search",data:{animationId:"search"}}],Ee=(()=>{let e=class{},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275mod=u({type:e})})(),(()=>{e.\u0275inj=h({imports:[P.forChild(Ne),P]})})(),t})();var qt=(()=>{let e=class{},t=e;return(()=>{e.\u0275fac=function(i){return new(i||e)}})(),(()=>{e.\u0275mod=u({type:e})})(),(()=>{e.\u0275inj=h({imports:[Y,ce,Ee,ee,X,C,ve,he,fe,T,H]})})(),t})();export{qt as SearchModule};
